# sorting-and-grouping-data
 CREATE DATABASE QUERYING1;
USE QUERYING1;
CREATE TABLE COUNTRY(Id INT PRIMARY KEY, Country_name VARCHAR(30),Population INT NOT NULL,Area VARCHAR(50));
CREATE TABLE PERSONS(Id INT PRIMARY KEY,F_name VARCHAR(30), L_name VARCHAR(30),Population INT,Rating INT CHECK(RATING<=10) ,Country_id INT, Country_name VARCHAR(30));
INSERT INTO COUNTRY VALUES(1,'CANADA',1000000,'ALBERTA');
INSERT INTO COUNTRY VALUES(2,'INDIA',1100000,'DELHI');
INSERT INTO COUNTRY VALUES(3,'CANADA',1200000,'ALBERTASASKATCHEWAN');
INSERT INTO COUNTRY VALUES(4,'USA',800000,'CALIFORNIA');
INSERT INTO COUNTRY VALUES(5,'AFGANISTAN',900000,'KHOST');
INSERT INTO COUNTRY VALUES(6,'BRAZIL',400000,'SALVADOR');
INSERT INTO COUNTRY VALUES(7,'CHILE',2200000,'SANTIAGO');
INSERT INTO COUNTRY VALUES(8,'DENMARK',1800000,'RIBE');
INSERT INTO COUNTRY VALUES(9,'ARGENTINA',5000000,'MENDOZA');
INSERT INTO COUNTRY VALUES(10,'SRILANKA',6000000,'MENOZA');


INSERT INTO PERSONS VALUES(11,'HALEEMA','ANAF',1000000,5,1,'CANADA');
INSERT INTO PERSONS VALUES(12,'AYISHA','BEEGAM',1000000,6,1,'CANADA');
INSERT INTO PERSONS VALUES(13,'NYNA','FASIL',900000,8,5,'AFGANISTAN');
INSERT INTO PERSONS VALUES(14,'MANJU','SUNIL',800000,3,4,'USA');
INSERT INTO PERSONS VALUES(15,'NAYAN','THARA',1100000,9,2,'INDIA');
INSERT INTO PERSONS VALUES(16,'THAS','LEENA',1100000,8,2,'INDIA');
INSERT INTO PERSONS VALUES(17,'NYHA','FAZY',400000,2,6,'BRAZIL');
INSERT INTO PERSONS VALUES(18,'SHERIN','JAHANA',2200000,6,7,'CHILE');
INSERT INTO PERSONS VALUES(19,'JASMIN','MOOSA',400000,5,6,'BRAZIL');
INSERT INTO PERSONS VALUES(20,'PRITHVI','SUKU',1000000,7,8,'DENMARK');
INSERT INTO PERSONS VALUES(21,'ALAN','DAVID',1000000,3,9,'ARGENTINA');
INSERT INTO PERSONS VALUES(22,'RAZIN','RAHMAN',1200000,5,3,'CANADA');
INSERT INTO PERSONS VALUES(23,'RAFIN','MUHD',1000000,5,1,'');
INSERT INTO PERSONS VALUES(24,'SHAHANA','SALIM',1000000,5,1,'');
INSERT INTO PERSONS VALUES(25,'LISHA','BIBIN',1000000,5,10,'UK');
INSERT INTO PERSONS VALUES(26,'HIJLA','ILYAS',1000000,5,10,'UK');

#WRITE AN SQL QUERY TO PRINT THE FIRST THREE CHARACTERS OF COUNTRY_NAME FROM COUNTRY TABLE
SELECT SUBSTR(COUNTRY_NAME,1,3) FROM COUNTRY;

#WRITE AN SQL QUERY TO CONCATENATE FIRST NAME AND LAST NAME FROM PERSONS TABLE
SELECT CONCAT(F_name,' ',L_name) AS 'FULL NAME' FROM PERSONS;

#WRITE AN SQL QUERY TO COUNT THE NUMBER OF UNIQUE COUNTRY NAMES FROM PERSONS TABLE
SELECT COUNT(DISTINCT Country_name) FROM PERSONS;

SELECT * FROM PERSONS;

#WRITE A QUERY TO PRINT THE MAXIMUM POPULATION FROM THE COUNTRY TABLE
SELECT MAX(Population) FROM COUNTRY;

#WRITE A QUERY TO PRINT THE MINIMUM POPULATION FROM PERSONS TABLE
SELECT MIN(Population) FROM PERSONS;

#INSERT 2 NEW ROWS TO PERSONS TABLE MAKING THE L_name NULL
INSERT INTO PERSONS VALUES(27,'HIJLA',NULL,8800000,9,10,'UK');
INSERT INTO PERSONS VALUES(28,'HIJU',NULL,9000000,8,10,'UK');
SELECT COUNT(L_name) FROM PERSONS;

#WRITE A QUERY TO FIND THE NUMBER OF ROWS IN PERSONS TABLE
SELECT COUNT(*) FROM PERSONS;

#WRITE AN SQL QUERY TO SHOW THE POPULATION OF THE COUNTRY TABLE FOR THE FIRST 3 ROWS
SELECT Population FROM COUNTRY LIMIT 3;

#WRITE A QUERY TO PRINT 3 RANDOM ROWS OF COUNTRIES
SELECT * FROM COUNTRY ORDER BY RAND() LIMIT 3;

#LIST ALL PERSONS ORDERED BY THEIR RATING IN DESCENTING ORDER
SELECT F_name FROM PERSONS ORDER BY RATING DESC;

#FIND THE TOTAL POPULATION OF EACH COUNTRY IN THE PERSONS TABLE
SELECT Country_name,SUM(Population) FROM PERSONS GROUP BY Country_name;

#FIND COUNTRIES IN THE PERSONS TABLE WITH A TOTAL POPULATION GREATER THAN 500000
SELECT Country_name,SUM(Population) FROM PERSONS GROUP BY Country_name HAVING SUM(Population)>500000;

#LIST THE TOTAL NUMBER OF PERSONS AND AVERAGE RATING FOR EACH COUNTRY , BUT ONLY FOR COUNTRIES WITH MORE THAN 2 PERSONS, ORDERED BY THE AVERAGE RATING IN ASCENTING ORDER
SELECT COUNT(F_name),avg(Rating) FROM PERSONS group by Country_name having count(country_name)>2 order by avg(rating) asc;

 
